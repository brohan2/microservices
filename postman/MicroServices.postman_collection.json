{
  "info": {
    "name": "MicroServices - User Management",
    "_postman_id": "c1f5e2a3-2f0a-4b1e-9c9e-7d2a6b9a1d21",
    "description": "Postman collection covering health, auth, signup, and invites.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Health",
      "item": [
        {
          "name": "GET /",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                ""
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Password",
      "item": [
        {
          "name": "POST /api/user/forgot",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{userEmail}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/user/forgot",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "user",
                "forgot"
              ]
            }
          }
        },
        {
          "name": "POST /api/user/forgot/verify-otp",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{userEmail}}\",\n  \"otp_received\": \"{{otpCode}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/user/forgot/verify-otp",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "user",
                "forgot",
                "verify-otp"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "  try {",
                  "    const data = pm.response.json();",
                  "    if (data.resetToken) pm.collectionVariables.set(\"resetToken\", data.resetToken);",
                  "  } catch (e) {}",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "POST /api/user/forgot/verify-totp",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{userEmail}}\",\n  \"token\": \"{{totpToken}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/user/forgot/verify-totp",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "user",
                "forgot",
                "verify-totp"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "  try {",
                  "    const data = pm.response.json();",
                  "    if (data.resetToken) pm.collectionVariables.set(\"resetToken\", data.resetToken);",
                  "  } catch (e) {}",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "POST /api/user/password/reset",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"resetToken\": \"{{resetToken}}\",\n  \"newPassword\": \"{{newPassword}}\",\n  \"confirmNewPassword\": \"{{newPassword}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/user/password/reset",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "user",
                "password",
                "reset"
              ]
            }
          }
        },
        {
          "name": "PATCH /api/user/password",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"currentPassword\": \"{{userPassword}}\",\n  \"newPassword\": \"{{newPassword}}\",\n  \"confirmNewPassword\": \"{{newPassword}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/user/password",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "user",
                "password"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Auth",
      "item": [
        {
          "name": "POST /api/user/login",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{userEmail}}\",\n  \"password\": \"{{userPassword}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/user/login",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "user",
                "login"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "  try {",
                  "    const data = pm.response.json();",
                  "    if (data.token) pm.collectionVariables.set(\"token\", data.token);",
                  "    if (data.refreshToken) pm.collectionVariables.set(\"refreshToken\", data.refreshToken);",
                  "  } catch (e) {}",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "POST /api/user/validateotplogin",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{userEmail}}\",\n  \"otp_received\": \"{{otpCode}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/user/validateotplogin",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "user",
                "validateotplogin"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "  try {",
                  "    const data = pm.response.json();",
                  "    if (data.token) pm.collectionVariables.set(\"token\", data.token);",
                  "    if (data.refreshToken) pm.collectionVariables.set(\"refreshToken\", data.refreshToken);",
                  "  } catch (e) {}",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "POST /api/user/validatetotplogin",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{userEmail}}\",\n  \"token\": \"{{totpToken}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/user/validatetotplogin",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "user",
                "validatetotplogin"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "  try {",
                  "    const data = pm.response.json();",
                  "    if (data.token) pm.collectionVariables.set(\"token\", data.token);",
                  "    if (data.refreshToken) pm.collectionVariables.set(\"refreshToken\", data.refreshToken);",
                  "  } catch (e) {}",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "POST /api/user/refresh",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refreshToken\": \"{{refreshToken}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/user/refresh",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "user",
                "refresh"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "  try {",
                  "    const data = pm.response.json();",
                  "    if (data.token) pm.collectionVariables.set(\"token\", data.token);",
                  "  } catch (e) {}",
                  "}"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Signup",
      "item": [
        {
          "name": "PATCH /api/user/invitedsignup (otp or totp)",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"{{inviteUsername}}\",\n  \"email\": \"{{inviteEmail}}\",\n  \"password\": \"{{invitePassword}}\",\n  \"confirmpassword\": \"{{invitePassword}}\",\n  \"invite_id\": \"{{inviteId}}\",\n  \"verification_preference\": \"{{verificationPreference}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/user/invitedsignup",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "user",
                "invitedsignup"
              ]
            }
          }
        },
        {
          "name": "PATCH /api/user/validateotpsignup",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{inviteEmail}}\",\n  \"otp_received\": \"{{otpCode}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/user/validateotpsignup",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "user",
                "validateotpsignup"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "  try {",
                  "    const data = pm.response.json();",
                  "    if (data.token) pm.collectionVariables.set(\"token\", data.token);",
                  "    if (data.refreshToken) pm.collectionVariables.set(\"refreshToken\", data.refreshToken);",
                  "  } catch (e) {}",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "PATCH /api/user/validatetotpsignup",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{inviteEmail}}\",\n  \"token\": \"{{totpToken}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/user/validatetotpsignup",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "user",
                "validatetotpsignup"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "  try {",
                  "    const data = pm.response.json();",
                  "    if (data.token) pm.collectionVariables.set(\"token\", data.token);",
                  "    if (data.refreshToken) pm.collectionVariables.set(\"refreshToken\", data.refreshToken);",
                  "  } catch (e) {}",
                  "}"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Invites",
      "item": [
        {
          "name": "POST /api/invite",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"inviteEmail\": \"{{inviteEmail}}\",\n  \"inviteRole\": \"{{inviteRole}}\",\n  \"organisation\": \"{{organisation}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/invite",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "invite"
              ]
            }
          }
        },
        {
          "name": "POST /api/inviteelist",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"irole\": \"{{inviteRole}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/inviteelist",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "inviteelist"
              ]
            }
          }
        },
        {
          "name": "POST /api/invite/revoke",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"invite_id\": \"{{inviteId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/invite/revoke",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "invite",
                "revoke"
              ]
            }
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8000"
    },
    {
      "key": "token",
      "value": ""
    },
    {
      "key": "userEmail",
      "value": "user@example.com"
    },
    {
      "key": "userPassword",
      "value": "password123"
    },
    {
      "key": "otpCode",
      "value": ""
    },
    {
      "key": "totpToken",
      "value": ""
    },
    {
      "key": "inviteUsername",
      "value": "invited.user"
    },
    {
      "key": "inviteEmail",
      "value": "invited@example.com"
    },
    {
      "key": "invitePassword",
      "value": "password123"
    },
    {
      "key": "inviteId",
      "value": ""
    },
    {
      "key": "verificationPreference",
      "value": "otp"
    },
    {
      "key": "inviteRole",
      "value": "client_user"
    },
    {
      "key": "organisation",
      "value": "Acme Corp"
    },
    {
      "key": "refreshToken",
      "value": ""
    },
    {
      "key": "newPassword",
      "value": "new-password-123"
    },
    {
      "key": "resetToken",
      "value": ""
    },
    {
      "key": "deleteUserId",
      "value": ""
    }
  ]
}

